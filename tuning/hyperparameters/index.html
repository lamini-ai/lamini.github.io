
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://lamini-ai.github.io/tuning/hyperparameters/" rel="canonical"/>
<link href="../memory_tuning/" rel="prev"/>
<link href="../large_data_files/" rel="next"/>
<link href="../../assets/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.5.49" name="generator"/>
<title>Hyperparameters - Lamini Docs</title>
<link href="../../assets/stylesheets/main.6f8fc17f.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<style>:root{--md-admonition-icon--note:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.75 1.75 0 0 1 1 7.775m1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/></svg>');}</style>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
<link href="../../stylesheets/extra.css" rel="stylesheet"/>
<link href="../../stylesheets/oad.css" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<!-- Start of HubSpot Embed Code -->
<script async="" defer="" id="hs-script-loader" src="//js.hs-scripts.com/39600519.js" type="text/javascript"></script>
<!-- End of HubSpot Embed Code -->
<!-- Start of Google Analytics Code -->
<script async="" src="https://www.googletagmanager.com/gtag/js?id=None"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'None');
</script>
<!-- End of Google Analytics Code -->
<!-- Start of Unify Code -->
<script>
  !function(){
    window.unify||(window.unify=Object.assign([],["identify","page","startAutoPage","stopAutoPage","startAutoIdentify","stopAutoIdentify"].reduce((function(t,e){
      return t[e]=function(){
        return unify.push([e,[].slice.call(arguments)]),unify
      },t
    }),{})));
    var t=document.createElement("script");
    t.async=!0,t.setAttribute("src","None"),t.setAttribute("data-api-key","None"),t.setAttribute("id","unifytag"),(document.body||document.head).appendChild(t)
  }();
</script>
<!-- End of Unify Code -->
<!-- Start of RB2B Code -->
<script>
  !function (){
    var reb2b = window.reb2b = window.reb2b || [];
    if (reb2b.invoked) return;
    reb2b.invoked = true;
    reb2b.methods = ["identify", "collect"];
    reb2b.factory = function (method) {
      return function () {
        var args = Array.prototype.slice.call(arguments);
        args.unshift(method);
        reb2b.push(args);
        return reb2b;
      };
    };
    for (var i = 0; i < reb2b.methods.length; i++) {
      var key = reb2b.methods[i];
      reb2b[key] = reb2b.factory(key);
    }
    reb2b.load = function (key) {
      var script = document.createElement("script");
      script.type = "text/javascript";
      script.async = true;
      script.src = "https://s3-us-west-2.amazonaws.com/b2bjsstore/b/" + key + "/None.js.gz";
      var first = document.getElementsByTagName("script")[0];
      first.parentNode.insertBefore(script, first);
    };
    reb2b.SNIPPET_VERSION = "1.0.1";
    reb2b.load("None");
  }();
</script>
<!-- End of RB2B Code -->
<!-- Example from MkDocs
<script>
  /* Add custom analytics integration here, e.g. */
  var property = ""
  /* Wait for page to load and application to mount */
  document.addEventListener("DOMContentLoaded", function() {
    location$.subscribe(function(url) {
      /* Add custom page event tracking here */
    })
  })
</script> -->
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="default" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#hyperparameters">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
<nav aria-label="Header" class="md-header__inner md-grid">
<a aria-label="Lamini Docs" class="md-header__button md-logo" data-md-component="logo" href="../.." title="Lamini Docs">
<img alt="logo" src="../../assets/logo.png"/>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            Lamini Docs
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Hyperparameters
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Switch to light mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Switch to light mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"></path></svg>
</label>
<input aria-label="Switch to dark mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_2" hidden="" title="Switch to dark mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
<input aria-label="Switch to system preference" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_2" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Switch to system preference">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="Search" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</label>
<nav aria-label="Search" class="md-search__options">
<button aria-label="Clear" class="md-search__icon md-icon" tabindex="-1" title="Clear" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Initializing search
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
<nav aria-label="Tabs" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../..">
          
  
  Documentation

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../lamini_python_class/lamini/">
          
  
  Python SDK

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../api/">
        
  
    
  
  REST API

      </a>
</li>
</ul>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="Lamini Docs" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="Lamini Docs">
<img alt="logo" src="../../assets/logo.png"/>
</a>
    Lamini Docs
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
<span class="md-ellipsis">
    Documentation
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_1_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_1">
<span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_1" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_1" id="__nav_1_1_label" tabindex="0">
<span class="md-ellipsis">
    Get Started
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_1_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_1">
<span class="md-nav__icon md-icon"></span>
            Get Started
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../..">
<span class="md-ellipsis">
    Introduction
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../quick_start/">
<span class="md-ellipsis">
    Quick Start
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../faq/">
<span class="md-ellipsis">
    FAQ
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_2" id="__nav_1_2_label" tabindex="0">
<span class="md-ellipsis">
    Memory RAG
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_2_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_2">
<span class="md-nav__icon md-icon"></span>
            Memory RAG
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../memory_rag/">
<span class="md-ellipsis">
    Quick Start
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_3" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_3" id="__nav_1_3_label" tabindex="0">
<span class="md-ellipsis">
    Classifier Agent Toolkit
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_3_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_3">
<span class="md-nav__icon md-icon"></span>
            Classifier Agent Toolkit
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../cat/">
<span class="md-ellipsis">
    Quick Start
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_1_4" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_4" id="__nav_1_4_label" tabindex="0">
<span class="md-ellipsis">
    Memory Tuning
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="true" aria-labelledby="__nav_1_4_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_4">
<span class="md-nav__icon md-icon"></span>
            Memory Tuning
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../memory_tuning/">
<span class="md-ellipsis">
    Quick Start
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Hyperparameters
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="./">
<span class="md-ellipsis">
    Hyperparameters
  </span>
</a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#finetune_args">
<span class="md-ellipsis">
      finetune_args
    </span>
</a>
<nav aria-label="finetune_args" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#immutables">
<span class="md-ellipsis">
      Immutables
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#gpu_config">
<span class="md-ellipsis">
      gpu_config
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data_or_dataset_id">
<span class="md-ellipsis">
      data_or_dataset_id
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../large_data_files/">
<span class="md-ellipsis">
    Large Data Files
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../evaluation/">
<span class="md-ellipsis">
    Evaluation UI
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_5" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_5" id="__nav_1_5_label" tabindex="0">
<span class="md-ellipsis">
    Inference
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_5">
<span class="md-nav__icon md-icon"></span>
            Inference
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../inference/prompt_templates/">
<span class="md-ellipsis">
    Prompt Templates
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../inference/json_output/">
<span class="md-ellipsis">
    JSON Output
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../inference/batching/">
<span class="md-ellipsis">
    Batching
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../inference/streaming/">
<span class="md-ellipsis">
    Streaming
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../inference/performance/">
<span class="md-ellipsis">
    Performance
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_6" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_6" id="__nav_1_6_label" tabindex="0">
<span class="md-ellipsis">
    Platform
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_6">
<span class="md-nav__icon md-icon"></span>
            Platform
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../authenticate/">
<span class="md-ellipsis">
    API Authentication
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../models/">
<span class="md-ellipsis">
    Supported Models
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_1_7" type="checkbox"/>
<label class="md-nav__link" for="__nav_1_7" id="__nav_1_7_label" tabindex="0">
<span class="md-ellipsis">
    Self-Hosted Lamini
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_1_7_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_1_7">
<span class="md-nav__icon md-icon"></span>
            Self-Hosted Lamini
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../self_managed/kubernetes_install/">
<span class="md-ellipsis">
    Kubernetes Install
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../self_managed/aws_eks_setup/">
<span class="md-ellipsis">
    AWS EKS Setup
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../self_managed/OIDC/">
<span class="md-ellipsis">
    OIDC User Auth
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../self_managed/model_management/">
<span class="md-ellipsis">
    Model Management
  </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle md-toggle--indeterminate" id="__nav_2" type="checkbox"/>
<label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
<span class="md-ellipsis">
    Python SDK
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<nav aria-expanded="false" aria-labelledby="__nav_2_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_2">
<span class="md-nav__icon md-icon"></span>
            Python SDK
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../lamini_python_class/lamini/">
<span class="md-ellipsis">
    lamini
  </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="../../api/">
<span class="md-ellipsis">
    REST API
  </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#finetune_args">
<span class="md-ellipsis">
      finetune_args
    </span>
</a>
<nav aria-label="finetune_args" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#immutables">
<span class="md-ellipsis">
      Immutables
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#gpu_config">
<span class="md-ellipsis">
      gpu_config
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data_or_dataset_id">
<span class="md-ellipsis">
      data_or_dataset_id
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<h1 id="hyperparameters">Hyperparameters</h1>
<p>Lamini tuning supports most hyperparameters in <a href="https://huggingface.co/docs/transformers/v4.33.3/en/main_classes/trainer#transformers.TrainingArguments">HuggingFace's training arguments</a>, as well as some Lamini-specific options.</p>
<p>These can be set in the <code>tune</code> method:</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="c1"># code/hyperparameters.py</span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">lamini</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lamini</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="n">llm</span> <span class="o">=</span> <span class="n">Lamini</span><span class="p">(</span><span class="n">model_name</span><span class="o">=</span><span class="s2">"meta-llama/Meta-Llama-3.1-8B-Instruct"</span><span class="p">)</span>
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="n">data</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="__span-0-7"><a href="#__codelineno-0-7" id="__codelineno-0-7" name="__codelineno-0-7"></a>    <span class="p">{</span>
</span><span id="__span-0-8"><a href="#__codelineno-0-8" id="__codelineno-0-8" name="__codelineno-0-8"></a>        <span class="s2">"input"</span><span class="p">:</span> <span class="s2">"What is Lamini? Is it like a robot or a computer program?"</span><span class="p">,</span>
</span><span id="__span-0-9"><a href="#__codelineno-0-9" id="__codelineno-0-9" name="__codelineno-0-9"></a>        <span class="s2">"output"</span><span class="p">:</span> <span class="s2">"Lamini is a program for the execution of LLMs called a large language model engine. It is not a robot, but rather a tool for building and executing LLMs."</span><span class="p">,</span>
</span><span id="__span-0-10"><a href="#__codelineno-0-10" id="__codelineno-0-10" name="__codelineno-0-10"></a>    <span class="p">}</span>
</span><span id="__span-0-11"><a href="#__codelineno-0-11" id="__codelineno-0-11" name="__codelineno-0-11"></a><span class="p">]</span>
</span><span id="__span-0-12"><a href="#__codelineno-0-12" id="__codelineno-0-12" name="__codelineno-0-12"></a>
</span><span id="__span-0-13"><a href="#__codelineno-0-13" id="__codelineno-0-13" name="__codelineno-0-13"></a><span class="n">results</span> <span class="o">=</span> <span class="n">llm</span><span class="o">.</span><span class="n">tune</span><span class="p">(</span><span class="n">data_or_dataset_id</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">finetune_args</span><span class="o">=</span><span class="p">{</span><span class="s2">"learning_rate"</span><span class="p">:</span> <span class="mf">1.0e-4</span><span class="p">})</span>
</span></code></pre></div>
<p>See <a href="../memory_tuning/#example-memory-tuning-settings">Memory Tuning</a> for use-case specific suggestions.</p>
<h2 id="finetune_args">finetune_args</h2>
<ul>
<li><strong>max_finetuning_examples</strong> (int, optional)</li>
<li>Default: size of the dataset</li>
<li>
<p>Sets the maximum number of data points for fine-tuning. If not set, the model is fine-tuned on the entire dataset.</p>
</li>
<li>
<p><strong>max_steps</strong> (int, optional)</p>
</li>
<li>Default: <code>100</code></li>
<li>Specifies the total number of training steps to perform.</li>
<li>
<p>This parameter is passed to <a href="https://huggingface.co/docs/transformers/v4.44.2/en/main_classes/trainer#transformers.TrainingArguments.max_steps">HuggingFace's Transformers TrainingArguments</a>.</p>
</li>
<li>
<p><strong>gradient_accumulation_steps</strong> (int, optional)</p>
</li>
<li>Default: <code>2</code></li>
<li>Number of update steps to accumulate the gradients for, before performing a backward/update pass.</li>
<li>Usage note: a higher setting can improve memory efficiency and thus reduce training time, often with a neutral effect on model accuracy.</li>
<li>
<p>This parameter is passed to <a href="https://huggingface.co/docs/transformers/v4.44.2/en/main_classes/trainer#transformers.TrainingArguments.gradient_accumulation_steps">HuggingFace's Transformers TrainingArguments</a>.</p>
</li>
<li>
<p><strong>learning_rate</strong> (float, optional)</p>
</li>
<li>Default: <code>9.0e-4</code></li>
<li>The initial learning rate for the fine-tuning.</li>
<li>This parameter is passed to <a href="https://huggingface.co/docs/transformers/v4.44.2/en/main_classes/trainer#transformers.TrainingArguments.learning_rate">HuggingFace's Transformers TrainingArguments</a>.</li>
<li>
<p>Usage note: see the <a href="../memory_tuning/#example-memory-tuning-settings">Memory Tuning</a> section for tips on setting learning rate.</p>
</li>
<li>
<p><strong>save_steps</strong> (int or float, optional)</p>
</li>
<li>Default: <code>60</code></li>
<li>Number of update steps between two checkpoint saves.</li>
<li>
<p>This parameter is passed to <a href="https://huggingface.co/docs/transformers/v4.44.2/en/main_classes/trainer#transformers.TrainingArguments.save_steps">HuggingFace's Transformers TrainingArguments</a>.</p>
</li>
<li>
<p><strong>max_length</strong> (int, optional)</p>
</li>
<li>Default: <code>2048</code></li>
<li>Specifies the maximum sequence length for the forward pass, acting as the block size for the model.</li>
<li>Should be a power of 2, no larger than <code>8192</code>.</li>
<li>
<p>Usage note: <code>max_length</code> should be at least as large as the size of your datapoints. If training with large datapoints is not converging, increasing this value may help. However, larger values of <code>max_length</code> increase training time, and very large values will exhaust GPU memory. There's often room to reduce the size of your datapoints so a smaller <code>max_length</code> can be used.</p>
</li>
<li>
<p><strong>optim</strong> (str, optional)</p>
</li>
<li>Default: <code>"adafactor"</code></li>
<li>The optimizer to use: <code>adamw_hf</code>, <code>adamw_torch</code>, <code>adamw_torch_fused</code>, <code>adamw_apex_fused</code>, <code>adamw_anyprecision</code> or <code>adafactor</code>.</li>
<li>
<p>This parameter is passed to <a href="https://huggingface.co/docs/transformers/main/en/main_classes/trainer#transformers.TrainingArguments.optim">HuggingFace's Transformers TrainingArguments</a>.</p>
</li>
<li>
<p><strong>r_value</strong> (int, optional)</p>
</li>
<li>Default: <code>64</code></li>
<li>
<p>Specifies the size of the LoRA (Low-Rank Adaptation) component.</p>
</li>
<li>
<p><strong>index_method</strong> (str, optional)</p>
</li>
<li>Default: <code>"IndexIVFPQ"</code></li>
<li>
<p>The index method used for approximate nearest neighbor search of high-dimensional vectors: <code>IndexIVFPQ</code>, <code>IndexHNSWPQ</code>,<code>IndexHNSWFlat</code>, <code>IndexFlatL2</code>, <code>IndexPQ</code></p>
</li>
<li>
<p><strong>index_k</strong> (int, optional)</p>
</li>
<li>Default: <code>2</code></li>
<li>
<p>Determines the number of nearest neighbors to consider.</p>
</li>
<li>
<p><strong>index_max_size</strong> (int, optional)</p>
</li>
<li>Default: <code>65536</code></li>
<li>
<p>Maximum size of the index.</p>
</li>
<li>
<p><strong>index_pq_m</strong> (int, optional)</p>
</li>
<li>Default: <code>8</code></li>
<li>Number of factors of product quantization.</li>
<li>
<p>Only used when <code>index_method</code> is <code>IndexIVFPQ</code> or <code>IndexPQ</code>. Ignored otherwise.</p>
</li>
<li>
<p><strong>index_pq_nbits</strong> (int, optional)</p>
</li>
<li>Default: <code>8</code></li>
<li>Number of bits in which each low-dimensional vector is stored. Range: [1, 16]</li>
<li>
<p>Only used when <code>index_method</code> is <code>IndexIVFPQ</code> or <code>IndexPQ</code>. Ignored otherwise.</p>
</li>
<li>
<p><strong>index_ivf_nlist</strong> (int, optional)</p>
</li>
<li>Default: <code>2048</code></li>
<li>Number of buckets during clustering for IVFLAT.</li>
<li>
<p>Only used when <code>index_method</code> is <code>IndexIVFPQ</code>. Ignored otherwise.</p>
</li>
<li>
<p><strong>index_ivf_nprobe</strong> (int, optional)</p>
</li>
<li>Default: <code>48</code></li>
<li>Number of buckets to search during the first step of IVFLAT.</li>
<li>
<p>Only used when <code>index_method</code> is <code>IndexIVFPQ</code>. Ignored otherwise.</p>
</li>
<li>
<p><strong>index_hnsw_m</strong> (int, optional)</p>
</li>
<li>Default: <code>32</code></li>
<li>Range: [4, 64]. Used in HNSW (Hierarchical Navigable Small World Graph) algorithm.</li>
<li>
<p>Only used when <code>index_method</code> is <code>IndexHNSWPQ</code> or <code>HNSWFlat</code>. Ignored otherwise.</p>
</li>
<li>
<p><strong>index_hnsw_efConstruction</strong> (int, optional)</p>
</li>
<li>Default: <code>16</code></li>
<li>Expansion factor at construction time for HNSW. Range: [8, 512]</li>
<li>
<p>Only used when <code>index_method</code> is <code>IndexHNSWPQ</code> or <code>HNSWFlat</code>. Ignored otherwise.</p>
</li>
<li>
<p><strong>index_hnsw_efSearch</strong> (int, optional)</p>
</li>
<li>Default: <code>8</code></li>
<li>Expansion factor at search time for HNSW.</li>
<li>Only used when <code>index_method</code> is <code>IndexHNSWPQ</code> or <code>HNSWFlat</code>. Ignored otherwise.</li>
</ul>
<h3 id="immutables">Immutables</h3>
<p>The following configs are only supported at their default values:</p>
<ul>
<li><strong>batch_size: 1</strong></li>
<li><strong>early_stopping: false</strong></li>
<li><strong>num_train_epochs</strong>: Will be overriden by <code>max_steps</code></li>
<li><strong>temperature: 0</strong></li>
<li><strong>lora_alpha: 1</strong></li>
</ul>
<h2 id="gpu_config">gpu_config</h2>
<ul>
<li><strong>gpus</strong>: (int, optional)</li>
<li>Default: <code>1</code></li>
<li>Number of GPUs per node to use for the tuning job.</li>
<li><strong>nodes</strong>: (int, optional)</li>
<li>Default: <code>1</code></li>
<li>Number of nodes (machines containing multiple GPUs) to use for the tuning job.</li>
</ul>
<div class="language-py highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="n">gpu_config</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a>    <span class="s2">"gpus"</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span>
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a>    <span class="s2">"nodes"</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
</span><span id="__span-1-4"><a href="#__codelineno-1-4" id="__codelineno-1-4" name="__codelineno-1-4"></a><span class="p">}</span>
</span></code></pre></div>
<p>The Lamini On-Demand allows a maximum of GPUs and nodes based on our server availability. If you are on Lamini Reserved or Self-managed, you can specify any number of GPUs and nodes within your provisioned cluster size. Your job will be queued until the requested number of GPUs and nodes is available.</p>
<p>If the required GPUs and nodes are not available, the configuration defaults to the system limit, and the job is queued until the resources become available. When using multiple nodes, specify the number of GPUs required per node.</p>
<p>Examples:</p>
<div class="language-py highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="n">gpu_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"gpus"</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">"nodes"</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>  <span class="c1"># total 8 GPUs</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="n">gpu_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"gpus"</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span> <span class="s2">"nodes"</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>  <span class="c1"># total 16 GPUs</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="n">gpu_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"gpus"</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s2">"nodes"</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>  <span class="c1"># total 8 GPUs</span>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="n">gpu_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"gpus"</span><span class="p">:</span> <span class="mi">9</span><span class="p">,</span> <span class="s2">"nodes"</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>  <span class="c1"># error, assuming max GPUs per node is 8</span>
</span></code></pre></div>
<h2 id="data_or_dataset_id">data_or_dataset_id</h2>
<ul>
<li><strong>data_or_dataset_id</strong> (JSONL or CSV file or dataset ID of an already uploaded dataset, required)</li>
<li>Default: no default</li>
<li>Specifies the dataset to use for the tuning job.</li>
</ul>
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
</main>
<footer class="md-footer">
<nav aria-label="Footer" class="md-footer__inner md-grid">
<a aria-label="Previous: Quick Start" class="md-footer__link md-footer__link--prev" href="../memory_tuning/">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                Previous
              </span>
<div class="md-ellipsis">
                Quick Start
              </div>
</div>
</a>
<a aria-label="Next: Large Data Files" class="md-footer__link md-footer__link--next" href="../large_data_files/">
<div class="md-footer__title">
<span class="md-footer__direction">
                Next
              </span>
<div class="md-ellipsis">
                Large Data Files
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
      Material for MkDocs
    </a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.code.copy", "navigation.instant", "navigation.tracking", "navigation.expand", "navigation.footer", "navigation.tabs", "navigation.tabs.sticky"], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
<script src="../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
<script>document$.subscribe(() => {
            window.update_swagger_ui_iframe_height = function (id) {
                var iFrameID = document.getElementById(id);
                if (iFrameID) {
                    full_height = (iFrameID.contentWindow.document.body.scrollHeight + 80) + "px";
                    iFrameID.height = full_height;
                    iFrameID.style.height = full_height;
                }
            }
        
            let iframe_id_list = []
            var iframes = document.getElementsByClassName("swagger-ui-iframe");
            for (var i = 0; i < iframes.length; i++) { 
                iframe_id_list.push(iframes[i].getAttribute("id"))
            }
        
            let ticking = true;
            
            document.addEventListener('scroll', function(e) {
                if (!ticking) {
                    window.requestAnimationFrame(()=> {
                        let half_vh = window.innerHeight/2;
                        for(var i = 0; i < iframe_id_list.length; i++) {
                            let element = document.getElementById(iframe_id_list[i])
                            if(element==null){
                                return
                            }
                            let diff = element.getBoundingClientRect().top
                            if(element.contentWindow.update_top_val){
                                element.contentWindow.update_top_val(half_vh - diff)
                            }
                        }
                        ticking = false;
                    });
                    ticking = true;
                }
            });
        
            const dark_scheme_name = "slate"
            
            window.scheme = document.body.getAttribute("data-md-color-scheme")
            const options = {
                attributeFilter: ['data-md-color-scheme'],
            };
            function color_scheme_callback(mutations) {
                for (let mutation of mutations) {
                    if (mutation.attributeName === "data-md-color-scheme") {
                        scheme = document.body.getAttribute("data-md-color-scheme")
                        var iframe_list = document.getElementsByClassName("swagger-ui-iframe")
                        for(var i = 0; i < iframe_list.length; i++) {
                            var ele = iframe_list.item(i);
                            if (ele) {
                                if (scheme === dark_scheme_name) {
                                    ele.contentWindow.enable_dark_mode();
                                } else {
                                    ele.contentWindow.disable_dark_mode();
                                }
                            }
                        }
                    }
                }
            }
            observer = new MutationObserver(color_scheme_callback);
            observer.observe(document.body, options);
            })</script></body>
</html>